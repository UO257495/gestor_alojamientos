<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
	<th:block th:replace="~{fragments/head :: head ('Buscador de alojamientos')}"></th:block>
</head>
<body>

	<div th:replace="~{fragments/menu :: principal}"></div>

    <section class="container contenido">

        <h1 class="mb-4">
            <i class="fa-solid fa-magnifying-glass text-secondary"></i>
            Buscador de alojamientos
        </h1>

         <div class="tab-content">

            <section class="container my-3">

                <!-- FORMULARIO DE BÚSQUEDA -->
                <form th:action="@{/gestion/alojamientos/buscar}" th:object="${busquedaForm}" method="get" id="busquedaForm" class="mb-4">

                    <div class="mb-3 row">
                        <label for="nombre" class="col-sm-2 col-form-label">Nombre</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="nombre" th:field="*{nombre}" placeholder="Ej: Casa Rural El Bosque" />
                        </div>
                    </div>

                    <div class="mb-3 row">
                        <label for="ubicacion" class="col-sm-2 col-form-label">Ubicación</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="ubicacion" th:field="*{ubicacion}" placeholder="Ej: Asturias" />
                        </div>
                    </div>

                    <div class="mb-3 row">
                        <label for="personas" class="col-sm-2 col-form-label">Personas</label>
                        <div class="col-sm-10">
                            <input type="number" class="form-control" id="personas" th:field="*{personas}" min="1" />
                        </div>
                    </div>

                    <div class="mb-3 row">
                        <label class="col-sm-2 col-form-label">Fechas</label>
                        <div class="col-sm-5">
                            <input type="date" class="form-control" id="fechaInicio" th:field="*{fechaInicio}" />
                        </div>
                        <div class="col-sm-5">
                            <input type="date" class="form-control" id="fechaFin" th:field="*{fechaFin}" />
                        </div>
                    </div>

                    <div class="text-end">
                        <button type="submit" class="btn btn-primary">
                            <i class="fa-solid fa-search"></i> Buscar
                        </button>
                    </div>
                </form>
            </section>
         </div>
        <!-- MAPA -->
        <div id="map"></div>

        <!-- LISTADO -->

    </section>


    <div th:replace="~{fragments/menu :: pie}"></div>

	<th:block th:replace="~{fragments/scripts :: scripts}"></th:block>

    <script src="https://cdn.jsdelivr.net/npm/ol@v10.3.1/dist/ol.js"></script>
    <script>
        // Inicializar mapa
        const map = new ol.Map({
        target: 'map',
        layers: [
            new ol.layer.Tile({
            source: new ol.source.OSM()
            })
        ],
        view: new ol.View({
            center: ol.proj.fromLonLat([-5.85, 43.36]), // Centro de Asturias
            zoom: 9
        })
        });

        // Capa vectorial para puntos de resultados
        // const vectorSource = new ol.source.Vector();
        // const vectorLayer = new ol.layer.Vector({ source: vectorSource });
        // map.addLayer(vectorLayer);

        // Manejar formulario de búsqueda
        // document.getElementById("busquedaForm").addEventListener("submit", function(e) {
        // e.preventDefault();
        // const nombre = document.getElementById("nombre").value;

        // Ejemplo estático de resultados (puedes cambiarlo por tu API)
        // const resultados = [
        //     { nombre: "Punto A", coords: [-3.7038, 40.4168] },
        //     { nombre: "Punto B", coords: [-0.3763, 39.4699] }
        // ];

        // Limpiar resultados anteriores
        // document.getElementById("resultados").innerHTML = "";
        // vectorSource.clear();

        // // Añadir resultados al listado y al mapa
        // resultados.forEach(r => {
        //     // Añadir al listado
        //     const fila = `<tr>
        //     <td>${r.nombre}</td>
        //     <td>${r.coords.join(", ")}</td>
        //     </tr>`;
        //     document.getElementById("resultados").insertAdjacentHTML("beforeend", fila);

        //     // Añadir marcador en el mapa
        //     const feature = new ol.Feature({
        //     geometry: new ol.geom.Point(ol.proj.fromLonLat(r.coords)),
        //     name: r.nombre
        //     });
        //     vectorSource.addFeature(feature);
        // });

        // // Ajustar vista del mapa a los resultados
        // if (resultados.length > 0) {
        //     const extent = vectorSource.getExtent();
        //     map.getView().fit(extent, { padding: [50, 50, 50, 50], maxZoom: 12 });
        // }
        // });
    </script>

</body>
</html>